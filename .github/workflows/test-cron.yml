name: Run Playwright Every Minute

on:
  schedule:
    - cron: "*/2 * * * *"   # every minute (UTC)
  workflow_dispatch:

jobs:
  run:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Install dependencies
        run: |
          npm init -y
          npm install playwright

      - name: Run script
        run: |
          node -e "
          const { chromium } = require('playwright');
          (async () => {
            const browser = await chromium.launch({ headless: true });
            const page = await browser.newPage();

            await page.goto(
              'https://bibi3.byethost13.com/ValidateEmails.php?Amount=79&Action=RunOnSecondaryServer',
              { waitUntil: 'commit' }   // don't wait for full load
            );

            await page.waitForTimeout(2000); // wait 3 seconds only

            await browser.close();
          })();
          "
